<main>
    <section class="breadcrumb">
        <div class="container">
            <div class="breadcrumb-main">
                <span>
                    Home
                </span>
                <i class="breadcrumb-icon fa-solid fa-chevron-right"></i>
                <span>
                    Products
                </span>
            </div>
        </div>
    </section>
    <section class="product">
        <div class="container">
            <div class="product-main">
                <div class="filter">
                    <h3 class="filter__title">FILTER</h3>
                    <div class="filter__categories">
                        <div class="filter__categories-title">
                            <h3>DANH MỤC</h3>
                            <i class="filter__categories-title-icon fa-solid fa-sort-down"></i>
                        </div>
                        <ul class="filter__list">
                            <li class="filter__list-item filter__list-item-text">
                                <input class="no-click"  type="checkbox" name="" id="" value="Basketball">
                                <span>Basketball</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Running">
                                <span>Running</span>
                            </li>

                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Gym">
                                <span>Gym</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Sneaker">
                                <span>Sneaker</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Football">
                                <span>Football</span>
                            </li>
                        </ul>            
                    </div>
                    <div class="filter__categories">
                        <div class="filter__categories-title">
                            <h3>BRAND</h3>
                            <i class="filter__categories-title-icon fa-solid fa-sort-down"></i>
                        </div>
                        <ul class="filter__list">
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="Nike">
                                <span>Nike</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Adidas">
                                <span>Adidas</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="New Balance">
                                <span>New Balance</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Vans">
                                <span>Vans</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="Puma">
                                <span>Puma</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="Jordan">
                                <span>Jordan</span>
                            </li>
                        </ul>            
                    </div>
                    <div class="filter__categories">
                        <div class="filter__categories-title">
                            <h3>SIZE</h3>
                            <i class="filter__categories-title-icon fa-solid fa-sort-down"></i>
                        </div>
                        <ul class="filter__list">
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="35">
                                <span>35</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="36">
                                <span>36</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="38">
                                <span>38</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="39">
                                <span>39</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="40">
                                <span>40</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="41">
                                <span>41</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text">
                                <input type="checkbox" name="" id="" value="42">
                                <span>42</span>
                            </li>
                            <li class="filter__list-item filter__list-item-text" >
                                <input type="checkbox" name="" id="" value="43">
                                <span>43</span>
                            </li>
                        </ul>            
                    </div>
                    <div class="filter__categories">
                        <div class="filter__categories-title">
                            <h3>COLOR</h3>
                            <i class="filter__categories-title-icon fa-solid fa-sort-down"></i>
                        </div>
                        <ul class="filter__list">
                            <li class="filter__list-item filter__list-item-color">
                                <div class="bg-white filter__list-color "></div>
                                <span>White</span>
                            </li>
                            <li class="filter__list-item filter__list-item-color">
                                <div class="bg-red filter__list-color"></div>
                                <span>Red</span>
                            </li>
                            <li class="filter__list-item filter__list-item-color">
                                <div class="bg-black filter__list-color"></div>
                                <span>Black</span>
                            </li>
                            <li class="filter__list-item filter__list-item-color">
                                <div class="bg-green filter__list-color"></div>
                                <span>Green</span>
                            </li>
                            <li class="filter__list-item filter__list-item-color">
                                <div class="bg-blue filter__list-color"></div>
                                <span>Blue</span>
                            </li>
                        </ul>            
                    </div>
                </div>
                <div class="show">
                    <!-- <div class="show-pannel_list">
                            <img src="./assets/img/product_pannel.png" alt="">
                            <img src="./assets/img/product_pannel.png" alt="">
                            <img src="./assets/img/product_pannel.png" alt="">
                    </div> -->
                    <div class="sort-filter_hidden">
                        <div class="sort">
                            <div class="sort-new btn-sort">
                                New
                            </div>
                            <div class="sort-hot btn-sort">
                                Hot
                            </div>
                            <div class="sort-price">
                                <div class="sort-price__title">
                                    Price
                                    <i class="sort-price__icon fa-regular fa-angle-down"></i>
                                </div>
                                <ul class="sort-price__list">
                                    <li class="sort-price__item sort-LowToHight">
                                        Price: from low to hight
                                    </li>
                                    <li class="sort-price__item sort-HightToLow">
                                        Price: from hight to low
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="hidden-filter">
                            Filters
                            <div class="btn-filter btn-filter--off">
                                <div class="btn-filter__on-off ">

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="target-result">
                        <div class="result">
                            <span class="result-number">
                                123
                            </span>
                            <span class="result-text">
                                Kết quả
                            </span>
                        </div>
                        <div class="tagret">
                            <!-- <div class="tagret-item">
                                <span>HiHiHi</span>
                                <i class="targer-icon fa-solid fa-xmark"></i>
                            </div> -->
                        </div>
                    </div>
                    <div class="list-shoes">
                        <!-- <div class="card">
                            <div class="card-img">
                                <img src="./assets/img/pd-1.png" alt="">
                            </div>
                            <p class="card-title">Nike Running Shoes</p>
                            <div class="card-price-rate">
                                <div class="card-price">
                                    <span>18.900.000 <u>đ</u></span>
                                    <span><del>18.900.000 <u>đ</u></del></span>  
                                </div>
                                <div class="card-rate">
                                    <i class="fa-solid fa-star"></i>
                                    4.5
                                </div>
                            </div>   
                            <i class="card-btn__like fa-regular fa-heart"></i>
                            <div class="card-new-hot">
                                <div class="card-special card-hot">
                                    Hot
                                </div>
                                <div class="card-special card-new">
                                    New
                                </div>
                            </div>
                        </div> -->
                    </div>
                    <div class="page">
                        <div class="page-main">
                            <div class="page-left page-left-right page-item--disable">
                                <i class="fa-solid fa-angle-left"></i>
                            </div>
                            <div class="page-number">
                                <div class="page-item page-item--select">
                                    1
                                </div>
                                <div class="page-item">
                                    2
                                </div>
                                <div class="page-item">
                                    3
                                </div>
                                <div class="page-item">
                                    4
                                </div>
                                <div class="page-item">
                                    5
                                </div>
                                <div class="page-dot">
                                    ...
                                </div>
                                <div class="page-item">
                                    10
                                </div>
                            </div>
                            <div class="page-right page-left-right">
                                <i class="fa-solid fa-angle-right "></i>
                            </div>
                        </div>
                    </div>  
                </div>
            </div>
        </div>
    </section>
</main>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-migrate-1.2.1.min.js" ></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<script>
    var listProduct=document.querySelector(".list-shoes");

    function insertTarget(keyWords){
        var newDiv=document.createElement("div");
        newDiv.classList.add("tagret-item");    
        newDiv.innerHTML=`
            <span>`+keyWords+`</span>
            <i class="targer-icon fa-solid fa-xmark"></i>
        `
        newDiv.children[1].addEventListener('click',function(){
            newDiv.remove();
            unCheckTag(keyWords);
            resultSearch();
        });
        var target=document.querySelector(".tagret");
        if(target){
            target.appendChild(newDiv);
        }
        }
    window.onload = function() {
        // Lấy thông tin sản phẩm từ query parameters
        const urlParams = new URLSearchParams(window.location.search);
        const tagret = urlParams.get("tagret");
        console.log(tagret);

        if(tagret!=null){
            console.log(tagret)
            insertTarget(tagret);
            //reset value input
            this.value=""
            resultSearch();
        }
    }
    function insertCard(render,divList){
        render.forEach((element,index) => {
            var newDiv= document.createElement("div");
            newDiv.classList.add("card");
            newDiv.innerHTML=`
            <div class="card-img">
                <img src="./assets/img/`+element.img+`" alt="">
            </div>
            <p class="card-title">`+element.title+`</p>
            <div class="card-price-rate">
                <div class="card-price">
                    <span>`+priceNew(element.price_old,element.sale)+`</span>
                    <span><del>`+element.price_old.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' })+`</del></span>  
                </div>
                <div class="card-rate">
                    <i class="fa-solid fa-star"></i>
                    `+element.rate+`
                </div>
            </div>   
            <i class="card-btn__like fa-regular fa-heart"></i>
            <div class="card-new-hot">
        
            </div>
            `
            newDiv.addEventListener('click',function(e){
            e.stopPropagation();//Ngăn chặn nổi bọt
            var url = 
            `product-detail.html?ob=${encodeURIComponent(JSON.stringify(element))}`;
            window.location.href = url;
            })
            
        
            //get tagNew and tagHot
            tagHotNew(element.new,element.hot,newDiv);
        
            divList.appendChild(newDiv);
            //like
            likeShoes(newDiv);
        });
        }
    function getSearch(){
        var arr=[];
        var tagret_item = document.querySelectorAll(".tagret-item");
        tagret_item.forEach(element => {
            var key=element.children[0].textContent.toLowerCase();
            arr.push(key);
        });
        return arr;
        }
    function searchObjectsByKeywords(objects, keywords) {
        var temp = []; // Danh sách mảng đối tượng tìm thấy
        if(keywords.length===0){
            temp = render;
            console.log(temp);
            return temp;
        
        }
    }
    function resultSearch(){
        document.querySelector(".list-shoes").innerHTML="";
        var arr=[]
        var arrObject=searchObjectsByKeywords(render,getSearch());
        for (var i = 0; i < render.length; i++) {
            for (var j = 0; j < arrObject.length; j++) {
            if (render[i].id === arrObject[j].id) {
                arr.push(render[i]);
            }
            }
        }
        insertCard(arr,listProduct);
        }
</script>